<!-- Content Header (Page header) -->
<section class="content-header">
  <h1>
    Evaluations
  </h1>
  <ol class="breadcrumb">
    <li><%= link_to ('<i class="fa fa-dashboard"> </i>Dashboard').html_safe, home_path %></li>
    <li class="active">Evaluations</li>
  </ol>
</section>

<section class="content container-fluid">
  <div class="row">
    <div class="col-xs-12">
      <div class="box box-primary">
        <div class="box-header with-border">
          <h3 class="box-title">Evaluations</h3>
        </div>
        <!-- /.box-header -->
        <% if can? :read, Evaluation %>
          <div class="box-body table-responsive no-padding">
            <table class="table table-hover">
              <tr>
                <th>Profiles</th>
                <th>Uploaded</th>
                <th>InSpec Version</th>
                <th>Platform name</th>
                <th>Platform release</th>
                <th>Statistics duration</th>
                <th>Owner</th>
                <th></th>
              </tr>

              <% @evaluations.each do |evaluation| %>
                <tr>
                  <td><%= link_to evaluation.profiles.map(&:name).join(', '), evaluation %></td>
                  <td><%= evaluation.created_at %></td>
                  <td><%= evaluation.version %></td>
                  <td><%= evaluation.platform_name %></td>
                  <td><%= evaluation.platform_release %></td>
                  <td><%= evaluation.statistics_duration %></td>
                  <td><%= evaluation.created_by.try(:email) %></td>
                  <td><% if can? :delete, evaluation %><%= link_to 'Destroy', evaluation, method: :delete, data: { confirm: 'Are you sure?' } %><% end %></td>
                </tr>
              <% end %>
            </table>
          </div>
        <% end %>
      </div>
    </div>
    <% if can? :create, Evaluation %>
      <div class="col-xs-6">
        <div class="box box-primary">
          <div class="box-header with-border">
            <h3 class="box-title">Upload Evaluation</h3>
          </div>
          <div class="box-body">
            <%= form_tag(upload_evaluation_path, multipart: true, :html => {class: 'form-control'}) do %>
              <div class="input-group">
                <%= file_field_tag :file, :class => "menu-text" %>
              </div>
              <br>
              <div class="actions">
                <%= submit_tag 'Upload', :class => "btn btn-info" %>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>
  </div>
</section>
<!-- /.content -->
